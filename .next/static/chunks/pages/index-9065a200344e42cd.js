(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(5947)}])},5947:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ve}});var a=t(5893),r=t(7294),l=t(8092),n=t(3359),c=t(467),d=t(4003),i=t(560),o=t(9842),x=t(6581),m=t(2845),u=t(5159),h=t(1448),g=t(8936),p=t(9832),j=t(278),b=t(282),f=t(1380),y=t(1924),N=t(1203),v=t(7783);const w=(0,r.createContext)(void 0),k=e=>{let{children:s}=e;const[t,l]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=localStorage.getItem("proxmox-theme");if(e){const s="dark"===e;l(s),n(s)}else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches;l(e),n(e)}const s=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{localStorage.getItem("proxmox-theme")||(l(e.matches),n(e.matches))};return s.addEventListener("change",t),()=>s.removeEventListener("change",t)}),[]);const n=e=>{e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")};return(0,a.jsx)(w.Provider,{value:{isDarkMode:t,toggleDarkMode:()=>{const e=!t;l(e),n(e),localStorage.setItem("proxmox-theme",e?"dark":"light")},setDarkMode:e=>{l(e),n(e),localStorage.setItem("proxmox-theme",e?"dark":"light")}},children:s})},S=()=>{const[e,s]=(0,r.useState)([]),[t,a]=(0,r.useState)([]),[l,n]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),[i,o]=(0,r.useState)(null),x=(0,r.useCallback)(((e,s)=>{if(!l)return!1;if(l.userid.startsWith("root@"))return!0;const t=l.permissions[e];if(t&&t.includes(s))return!0;const a=e.split("/");for(let r=a.length-1;r>0;r--){const e=a.slice(0,r).join("/"),t=l.permissions[e];if(t&&t.includes(s))return!0}return!1}),[l]),m=(0,r.useCallback)((async(e,s)=>{try{d(!0),o(null);return await e()}catch(t){const e=t.message;return o("".concat(s,": ").concat(e)),console.error("".concat(s,":"),t),null}finally{d(!1)}}),[]),u=(0,r.useCallback)((async()=>{const e=await m((()=>window.electronAPI.getUserInfo()),"Fetch user info");return e&&n(e),e}),[m]),h=(0,r.useCallback)((async()=>{const e=await m((()=>window.electronAPI.getNodes()),"Fetch nodes");return e?(s(e),e):[]}),[m]),g=(0,r.useCallback)((async()=>{const e=await m((()=>window.electronAPI.getClusterResources()),"Fetch cluster resources");return e?(a(e),e):[]}),[m]),p=(0,r.useCallback)((async e=>await m((()=>window.electronAPI.getVMs(e)),"Fetch VMs for node ".concat(e))||[]),[m]),j=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.startVM(e,s)),"Start VM ".concat(s))}),[m]),b=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.stopVM(e,s)),"Stop VM ".concat(s))}),[m]),f=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.rebootVM(e,s)),"Reboot VM ".concat(s))}),[m]),y=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.suspendVM(e,s)),"Suspend VM ".concat(s))}),[m]),N=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.resumeVM(e,s)),"Resume VM ".concat(s))}),[m]),v=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.shutdownVM(e,s)),"Shutdown VM ".concat(s))}),[m]),w=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.resetVM(e,s)),"Reset VM ".concat(s))}),[m]),k=(0,r.useCallback)((async e=>await m((()=>window.electronAPI.getContainers(e)),"Fetch containers for node ".concat(e))||[]),[m]),S=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.startContainer(e,s)),"Start container ".concat(s))}),[m]),C=(0,r.useCallback)((async(e,s)=>{await m((()=>window.electronAPI.stopContainer(e,s)),"Stop container ".concat(s))}),[m]),M=(0,r.useCallback)((async e=>await m((()=>window.electronAPI.getStorage(e)),"Fetch storage".concat(e?" for node ".concat(e):""))||[]),[m]),Z=(0,r.useCallback)((async(e,s,t)=>await m((()=>window.electronAPI.getStorageContent(e,s,t)),"Fetch storage content for ".concat(s))||[]),[m]),P=(0,r.useCallback)((async e=>await m((()=>window.electronAPI.getNetworkConfig(e)),"Fetch network config for node ".concat(e))),[m]),I=(0,r.useCallback)((async()=>await m((()=>window.electronAPI.getUsers()),"Fetch users")||[]),[m]),F=(0,r.useCallback)((async e=>await m((()=>window.electronAPI.createUser(e)),"Create user")),[m]),V=(0,r.useCallback)((async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hour";const t=await m((()=>window.electronAPI.getNodeStats(e,s)),"Fetch node stats for ".concat(e));return t}),[m]),A=(0,r.useCallback)((async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hour";const a=await m((()=>window.electronAPI.getVMStats(e,s,t)),"Fetch VM stats for ".concat(s));return a}),[m]);return{nodes:e,clusterResources:t,userInfo:l,loading:c,error:i,hasPermission:x,getUserInfo:u,fetchNodes:h,fetchClusterResources:g,getVMs:p,startVM:j,stopVM:b,rebootVM:f,suspendVM:y,resumeVM:N,shutdownVM:v,resetVM:w,getContainers:k,startContainer:S,stopContainer:C,getStorage:M,getStorageContent:Z,getNetworkConfig:P,getUsers:I,createUser:F,getNodeStats:V,getVMStats:A}};var C=t(5887),M=t(7706),Z=t(5019),P=t(2085),I=t(5103),F=t(1321);var V=e=>{let{onConnectionChange:s}=e;const[t,n]=(0,r.useState)({host:"",port:8006,username:"root",password:"",realm:"pam",ignoreSSL:!0}),[c,i]=(0,r.useState)(!1),[o,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[h,g]=(0,r.useState)(null),[p,b]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=localStorage.getItem("proxmox-connection-config");if(e)try{const s=JSON.parse(e);n(s)}catch(s){console.error("Failed to parse saved config:",s)}}),[]);const f=(e,s)=>{n((t=>({...t,[e]:s}))),g(null)};return(0,a.jsx)("div",{className:"min-h-screen p-6 bg-gray-50 dark:bg-gray-900",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-blue-600 rounded-full",children:(0,a.jsx)(j.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"ProxTop"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Proxmox VE Desktop Manager"})]}),p&&(0,a.jsx)("div",{className:"p-4 mb-6 border border-green-200 rounded-lg bg-green-50 dark:bg-green-900/20 dark:border-green-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-green-800 dark:text-green-300",children:["Connected to ",t.host,":",t.port]}),(0,a.jsxs)("p",{className:"text-sm text-green-600 dark:text-green-400",children:[t.username,"@",t.realm]})]})]}),(0,a.jsx)("button",{onClick:async()=>{try{await window.electronAPI.disconnect(),b(!1),s(!1),g(null)}catch(e){console.error("Failed to disconnect:",e)}},className:"btn-danger",children:"Disconnect"})]})}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6 mr-3 text-blue-600 dark:text-blue-400"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:p?"Connection Settings":"Connect to Proxmox VE"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Host/IP Address"}),(0,a.jsx)("input",{type:"text",value:t.host,onChange:e=>f("host",e.target.value),className:"input-field",placeholder:"192.168.1.100 or proxmox.example.com",disabled:p})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Port"}),(0,a.jsx)("input",{type:"number",value:t.port,onChange:e=>f("port",parseInt(e.target.value)||8006),className:"input-field",min:"1",max:"65535",disabled:p})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Username"}),(0,a.jsx)("input",{type:"text",value:t.username,onChange:e=>f("username",e.target.value),className:"input-field",placeholder:"root",disabled:p})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Realm"}),(0,a.jsxs)("select",{value:t.realm,onChange:e=>f("realm",e.target.value),className:"select-field",disabled:p,children:[(0,a.jsx)("option",{value:"pam",children:"Linux PAM"}),(0,a.jsx)("option",{value:"pve",children:"Proxmox VE"}),(0,a.jsx)("option",{value:"ad",children:"Active Directory"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:m?"text":"password",value:t.password,onChange:e=>f("password",e.target.value),className:"pr-10 input-field",placeholder:"Enter password",disabled:p}),(0,a.jsx)("button",{type:"button",onClick:()=>u(!m),className:"absolute inset-y-0 right-0 flex items-center pr-3",disabled:p,children:m?(0,a.jsx)(C.Z,{className:"w-4 h-4 text-gray-400"}):(0,a.jsx)(M.Z,{className:"w-4 h-4 text-gray-400"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"ignoreSSL",checked:t.ignoreSSL,onChange:e=>f("ignoreSSL",e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",disabled:p}),(0,a.jsx)("label",{htmlFor:"ignoreSSL",className:"block ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Ignore SSL certificate errors (recommended for self-signed certificates)"})]}),h&&(0,a.jsx)("div",{className:"p-4 rounded-lg ".concat(h.success?"bg-green-50 border border-green-200 dark:bg-green-900/20 dark:border-green-800":"bg-red-50 border border-red-200 dark:bg-red-900/20 dark:border-red-800"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[h.success?(0,a.jsx)(Z.Z,{className:"w-5 h-5 mr-2 text-green-600 dark:text-green-400"}):(0,a.jsx)(P.Z,{className:"w-5 h-5 mr-2 text-red-600 dark:text-red-400"}),(0,a.jsx)("span",{className:h.success?"text-green-800 dark:text-green-300":"text-red-800 dark:text-red-300",children:h.message})]})}),!p&&(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:async()=>{i(!0),g(null);try{const e=await window.electronAPI.connect(t);e.success?g({success:!0,message:"Connection test successful!"}):g({success:!1,message:e.error||"Connection test failed"})}catch(e){g({success:!1,message:e.message})}finally{i(!1)}},disabled:c||!t.host||!t.username||!t.password,className:"flex items-center space-x-2 btn-secondary",children:[c?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-gray-600 rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(I.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Test Connection"})]}),(0,a.jsxs)("button",{onClick:async()=>{x(!0),g(null);try{const e=await window.electronAPI.connect(t);e.success?(localStorage.setItem("proxmox-connection-config",JSON.stringify(t)),b(!0),s(!0,t),g({success:!0,message:"Connected successfully!"})):(g({success:!1,message:e.error||"Connection failed"}),b(!1),s(!1))}catch(e){g({success:!1,message:e.message}),b(!1),s(!1)}finally{x(!1)}},disabled:o||!t.host||!t.username||!t.password,className:"flex items-center flex-1 space-x-2 btn-primary",children:[o?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(F.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Connect"})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-8 card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-white",children:"Connection Help"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:"\u2022"}),(0,a.jsx)("p",{children:"Enter your Proxmox VE server's IP address or hostname"})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:"\u2022"}),(0,a.jsx)("p",{children:"Default port is 8006 (HTTPS web interface)"})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:"\u2022"}),(0,a.jsx)("p",{children:"Use your Proxmox VE username and password"})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:"\u2022"}),(0,a.jsx)("p",{children:'Enable "Ignore SSL errors" for self-signed certificates'})]})]})]})]})})},A=t(4498),U=t(935),D=t(9009),B=t(4831),E=t(4195),R=t(3023),L=t(5358),T=t(6050),_=t(8001);var z=()=>{const{nodes:e,clusterResources:s,loading:t,error:l,fetchNodes:n,fetchClusterResources:c,getUserInfo:i}=S(),[o,u]=(0,r.useState)(null),[h,g]=(0,r.useState)([]),[p,j]=(0,r.useState)(null),[b,f]=(0,r.useState)(null),[y,N]=(0,r.useState)(!1);(0,r.useEffect)((()=>{w();const e=setInterval(k,3e4);return()=>clearInterval(e)}),[]);const w=async()=>{try{const e=await i();j(e),await k()}catch(l){console.error("Failed to initialize dashboard:",l)}},k=(0,r.useCallback)((async()=>{N(!0);try{await Promise.all([n(),c()]),f(new Date)}catch(l){console.error("Failed to refresh data:",l)}finally{N(!1)}}),[n,c]);(0,r.useEffect)((()=>{if(0===e.length||0===s.length)return;const t=s.filter((e=>"vm"===e.type)),a=s.filter((e=>"lxc"===e.type)),r=e.filter((e=>"online"===e.status)),l={totalNodes:e.length,onlineNodes:r.length,totalVMs:t.length,runningVMs:t.filter((e=>"running"===e.status)).length,totalContainers:a.length,runningContainers:a.filter((e=>"running"===e.status)).length,totalMemory:e.reduce(((e,s)=>e+(s.maxmem||0)),0),usedMemory:e.reduce(((e,s)=>e+(s.mem||0)),0),totalStorage:e.reduce(((e,s)=>e+(s.maxdisk||0)),0),usedStorage:e.reduce(((e,s)=>e+(s.disk||0)),0),averageCPU:e.length>0?e.reduce(((e,s)=>e+100*(s.cpu||0)),0)/e.length:0};u(l);const n=e.map((e=>{const s=t.filter((s=>s.node===e.node)),r=a.filter((s=>s.node===e.node));return{timestamp:Date.now(),node:e.node,cpu:100*(e.cpu||0),memory:e.maxmem?(e.mem||0)/e.maxmem*100:0,memoryUsed:e.mem||0,memoryTotal:e.maxmem||0,diskUsage:e.maxdisk?(e.disk||0)/e.maxdisk*100:0,uptime:e.uptime||0,vms:s.length,containers:r.length}}));g(n)}),[e,s]);const C=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,s)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][s])},M=e=>{const s=Math.floor(e/86400),t=Math.floor(e%86400/3600);return"".concat(s,"d ").concat(t,"h")};return t&&!o?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-gray-300 rounded-full border-t-blue-600 animate-spin"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Loading cluster data..."})]})}):l?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(v.Z,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),(0,a.jsx)("h2",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:"Error Loading Data"}),(0,a.jsx)("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:l}),(0,a.jsxs)("button",{onClick:k,className:"btn-primary",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}):o?(0,a.jsxs)("div",{className:"min-h-screen p-6 space-y-6 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Cluster Dashboard"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(null===p||void 0===p?void 0:p.userid)&&"Welcome back, ".concat(p.userid.split("@")[0])})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[b&&(0,a.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last updated: ",b.toLocaleTimeString()]}),(0,a.jsxs)("button",{onClick:k,disabled:y,className:"btn-secondary",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2 ".concat(y?"animate-spin":"")}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg dark:bg-blue-900",children:(0,a.jsx)(d.Z,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Nodes"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[o.onlineNodes,"/",o.totalNodes]}),o.onlineNodes===o.totalNodes?(0,a.jsx)(Z.Z,{className:"w-5 h-5 ml-2 text-green-500"}):(0,a.jsx)(v.Z,{className:"w-5 h-5 ml-2 text-yellow-500"})]})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-lg dark:bg-green-900",children:(0,a.jsx)(x.Z,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Virtual Machines"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[o.runningVMs,"/",o.totalVMs]})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg dark:bg-purple-900",children:(0,a.jsx)(m.Z,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Containers"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[o.runningContainers,"/",o.totalContainers]})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-orange-100 rounded-lg dark:bg-orange-900",children:(0,a.jsx)(U.Z,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Average CPU"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:[o.averageCPU.toFixed(1),"%"]})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-white",children:"Memory Usage"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[C(o.usedMemory)," / ",C(o.totalMemory)]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[(o.usedMemory/o.totalMemory*100).toFixed(1),"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full dark:bg-gray-700",children:(0,a.jsx)("div",{className:"h-2 transition-all duration-1000 bg-purple-600 rounded-full",style:{width:"".concat(o.usedMemory/o.totalMemory*100,"%")}})})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-white",children:"Storage Usage"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[C(o.usedStorage)," / ",C(o.totalStorage)]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[(o.usedStorage/o.totalStorage*100).toFixed(1),"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full dark:bg-gray-700",children:(0,a.jsx)("div",{className:"h-2 transition-all duration-1000 bg-blue-600 rounded-full",style:{width:"".concat(o.usedStorage/o.totalStorage*100,"%")}})})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-white",children:"Node Resource Usage"}),(0,a.jsx)(D.h,{width:"100%",height:300,children:(0,a.jsxs)(B.v,{data:h,children:[(0,a.jsx)(E.q,{strokeDasharray:"3 3",className:"opacity-30"}),(0,a.jsx)(R.K,{dataKey:"node",className:"text-xs"}),(0,a.jsx)(L.B,{className:"text-xs"}),(0,a.jsx)(T.u,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:(e,s)=>["cpu"===s||"memory"===s||"diskUsage"===s?"".concat(e.toFixed(1),"%"):e,"cpu"===s?"CPU":"memory"===s?"Memory":"diskUsage"===s?"Disk":s]}),(0,a.jsx)(_.$,{dataKey:"cpu",fill:"#3b82f6",name:"cpu"}),(0,a.jsx)(_.$,{dataKey:"memory",fill:"#8b5cf6",name:"memory"}),(0,a.jsx)(_.$,{dataKey:"diskUsage",fill:"#10b981",name:"diskUsage"})]})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-white",children:"Node Details"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase dark:text-gray-400",children:"Node"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase dark:text-gray-400",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase dark:text-gray-400",children:"CPU"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase dark:text-gray-400",children:"Memory"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase dark:text-gray-400",children:"VMs/CTs"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase dark:text-gray-400",children:"Uptime"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:h.map((e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,a.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 whitespace-nowrap dark:text-white",children:e.node}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"status-running",children:"online"})}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400",children:[e.cpu.toFixed(1),"%"]}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400",children:[e.memory.toFixed(1),"%"]}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400",children:[e.vms,"/",e.containers]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap dark:text-gray-400",children:M(e.uptime)})]},e.node)))})]})})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(d.Z,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),(0,a.jsx)("h2",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:"No Cluster Data"}),(0,a.jsx)("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:"Connect to a Proxmox cluster to view dashboard"})]})})},O=t(597),K=t(3604),q=t(6208),G=t(3815);var J=()=>{const{nodes:e,clusterResources:s,loading:t,error:l,fetchNodes:n,fetchClusterResources:c}=S(),[o,m]=(0,r.useState)(null);if((0,r.useEffect)((()=>{n(),c();const e=setInterval((()=>{n(),c()}),3e4);return m(e),()=>{e&&clearInterval(e)}}),[n,c]),t&&0===e.length)return(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})});if(l)return(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(P.Z,{className:"mx-auto h-16 w-16 text-red-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-gray-500",children:l})]})});const u=s.filter((e=>"vm"===e.type)).length,h=s.filter((e=>"vm"===e.type&&"running"===e.status)).length,g=e.length,p=e.filter((e=>"online"===e.status)).length,b=e.map((e=>({name:e.node,cpu:Math.round(100*(e.cpu||0)),memory:Math.round((e.mem||0)/(e.maxmem||1)*100),disk:Math.round((e.disk||0)/(e.maxdisk||1)*100)}))),f=[{name:"Running",value:h,color:"#10b981"},{name:"Stopped",value:u-h,color:"#ef4444"}],y=e.reduce(((e,s)=>e+(s.maxmem||0)),0),N=e.reduce(((e,s)=>e+(s.mem||0)),0),v=e.reduce(((e,s)=>e+(s.maxdisk||0)),0),w=e.reduce(((e,s)=>e+(s.disk||0)),0);return(0,a.jsxs)("div",{className:"p-6 space-y-6 overflow-auto h-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Auto-refresh: 30s"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(d.Z,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Nodes"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[p,"/",g]}),p===g?(0,a.jsx)(O.Z,{className:"ml-2 h-5 w-5 text-green-500"}):(0,a.jsx)(P.Z,{className:"ml-2 h-5 w-5 text-yellow-500"})]})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(x.Z,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Virtual Machines"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[h,"/",u]})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(i.Z,{className:"h-6 w-6 text-purple-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Memory Usage"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[Math.round(N/y*100),"%"]})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(i.Z,{className:"h-6 w-6 text-orange-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Storage Usage"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[Math.round(w/v*100),"%"]})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Node Resource Usage"}),(0,a.jsx)(D.h,{width:"100%",height:300,children:(0,a.jsxs)(B.v,{data:b,children:[(0,a.jsx)(E.q,{strokeDasharray:"3 3"}),(0,a.jsx)(R.K,{dataKey:"name"}),(0,a.jsx)(L.B,{}),(0,a.jsx)(T.u,{formatter:e=>"".concat(e,"%")}),(0,a.jsx)(_.$,{dataKey:"cpu",fill:"#3b82f6",name:"CPU"}),(0,a.jsx)(_.$,{dataKey:"memory",fill:"#10b981",name:"Memory"}),(0,a.jsx)(_.$,{dataKey:"disk",fill:"#f59e0b",name:"Disk"})]})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"VM Status Distribution"}),(0,a.jsx)(D.h,{width:"100%",height:300,children:(0,a.jsxs)(K.u,{children:[(0,a.jsx)(q.b,{data:f,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,value:t}=e;return"".concat(s,": ").concat(t)},outerRadius:80,fill:"#8884d8",dataKey:"value",children:f.map(((e,s)=>(0,a.jsx)(G.b,{fill:e.color},"cell-".concat(s))))}),(0,a.jsx)(T.u,{})]})})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Node Status"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Node"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CPU Usage"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Memory Usage"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Uptime"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.node}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"online"===e.status?"status-running":"status-stopped",children:e.status})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[Math.round(100*(e.cpu||0)),"%"]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[Math.round((e.mem||0)/(e.maxmem||1)*100),"%"]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[Math.floor((e.uptime||0)/86400),"d ",Math.floor((e.uptime||0)%86400/3600),"h"]})]},e.node)))})]})})]})]})},$=t(7777),H=t(7119),W=t(113),X=t(3981),Y=t(994),Q=t(8301),ee=t(7154);var se=e=>{let{onOpenHardware:s,onOpenConsole:t}=e;const{nodes:l,clusterResources:n,startVM:c,stopVM:d,rebootVM:i,suspendVM:o,resumeVM:m,shutdownVM:u,loading:h,error:g,fetchNodes:j,fetchClusterResources:b}=S(),[f,y]=(0,r.useState)(""),[N,v]=(0,r.useState)({}),[w,k]=(0,r.useState)(""),[C,M]=(0,r.useState)("all"),[I,F]=(0,r.useState)(null),V=n.filter((e=>"vm"===e.type&&(""===f||e.node===f)));(0,r.useEffect)((()=>{l.length>0&&!f&&y(l[0].node)}),[l,f]),(0,r.useEffect)((()=>{U();const e=setInterval(U,1e4);return()=>clearInterval(e)}),[]);const U=(0,r.useCallback)((async()=>{try{await Promise.all([j(),b()]),F(new Date)}catch(g){console.error("Failed to refresh VM data:",g)}}),[j,b]),D=async(e,s,t)=>{const a="".concat(t,"-").concat(s);v((s=>({...s,[a]:e})));try{switch(e){case"start":await c(t,s.toString());break;case"stop":await d(t,s.toString());break;case"reboot":await i(t,s.toString());break;case"suspend":await o(t,s.toString());break;case"resume":await m(t,s.toString());break;case"shutdown":await u(t,s.toString())}setTimeout(U,2e3)}catch(g){console.error("Failed to ".concat(e," VM:"),g)}finally{v((e=>{const s={...e};return delete s[a],s}))}},B=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,s)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][s])},E=e=>{switch(e){case"running":return"status-running";case"stopped":return"status-stopped";case"suspended":return"status-paused";default:return"status-unknown"}},R=e=>{switch(e){case"running":return(0,a.jsx)(Z.Z,{className:"w-4 h-4"});case"stopped":default:return(0,a.jsx)(P.Z,{className:"w-4 h-4"});case"suspended":return(0,a.jsx)($.Z,{className:"w-4 h-4"})}},L=V.filter((e=>{var s,t;const a=""===w||(null===(s=e.vmid)||void 0===s?void 0:s.toString().includes(w))||(null===(t=e.node)||void 0===t?void 0:t.toLowerCase().includes(w.toLowerCase())),r="all"===C||e.status===C;return a&&r}));return h&&0===V.length?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-gray-300 rounded-full border-t-blue-600 animate-spin"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Loading virtual machines..."})]})}):g?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(P.Z,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),(0,a.jsx)("h2",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:"Error Loading VMs"}),(0,a.jsx)("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:g}),(0,a.jsxs)("button",{onClick:U,className:"btn-primary",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}):(0,a.jsxs)("div",{className:"min-h-screen p-6 space-y-6 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:justify-between lg:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Virtual Machines"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[L.length," VMs \u2022 ",L.filter((e=>"running"===e.status)).length," running"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[I&&(0,a.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last updated: ",I.toLocaleTimeString()]}),(0,a.jsxs)("button",{onClick:U,className:"btn-secondary",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:space-y-0 lg:space-x-6",children:[(0,a.jsxs)("select",{value:f,onChange:e=>y(e.target.value),className:"px-4 py-2 bg-white border border-gray-300 rounded-lg dark:bg-gray-800 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Nodes"}),l.map((e=>(0,a.jsx)("option",{value:e.node,children:e.node},e.node)))]}),(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(H.Z,{className:"absolute w-4 h-4 text-gray-400 transform -translate-y-1/2 left-3 top-1/2"}),(0,a.jsx)("input",{type:"text",placeholder:"Search VMs...",value:w,onChange:e=>k(e.target.value),className:"w-full py-2 pl-10 pr-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-800 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(W.Z,{className:"w-4 h-4 text-gray-400"}),(0,a.jsxs)("select",{value:C,onChange:e=>M(e.target.value),className:"px-3 py-2 bg-white border border-gray-300 rounded-lg dark:bg-gray-800 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"running",children:"Running"}),(0,a.jsx)("option",{value:"stopped",children:"Stopped"}),(0,a.jsx)("option",{value:"suspended",children:"Suspended"})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2 xl:grid-cols-3",children:L.map((e=>{const r="".concat(e.node,"-").concat(e.vmid),l=N[r];return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg dark:bg-blue-900",children:(0,a.jsx)(x.Z,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:["VM ",e.vmid]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Node: ",e.node]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("span",{className:"inline-flex items-center space-x-1 px-2 py-1 text-xs font-medium rounded-full ".concat(E(e.status)),children:[R(e.status),(0,a.jsx)("span",{children:e.status})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"CPU:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.maxcpu||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Memory:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.maxmem?B(e.maxmem):"N/A"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Disk:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.maxdisk?B(e.maxdisk):"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Usage:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.cpu?"".concat((100*e.cpu).toFixed(1),"%"):"0%"})]})]})]}),"running"===e.status&&(0,a.jsx)("div",{className:"p-3 mb-4 rounded-lg bg-green-50 dark:bg-green-900/20",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-green-700 dark:text-green-400",children:"CPU:"}),(0,a.jsx)("span",{className:"font-medium text-green-800 dark:text-green-300",children:e.cpu?"".concat((100*e.cpu).toFixed(1),"%"):"0%"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-green-700 dark:text-green-400",children:"Memory:"}),(0,a.jsx)("span",{className:"font-medium text-green-800 dark:text-green-300",children:e.mem&&e.maxmem?"".concat((e.mem/e.maxmem*100).toFixed(1),"%"):"0%"})]})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex space-x-2",children:"running"===e.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>D("stop",e.vmid,e.node),disabled:!!l,className:"flex items-center flex-1 space-x-1 btn-danger",children:["stop"===l?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(X.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Stop"})]}),(0,a.jsxs)("button",{onClick:()=>D("reboot",e.vmid,e.node),disabled:!!l,className:"flex items-center flex-1 space-x-1 btn-warning",children:["reboot"===l?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(Y.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Reboot"})]})]}):"suspended"===e.status?(0,a.jsxs)("button",{onClick:()=>D("resume",e.vmid,e.node),disabled:!!l,className:"flex items-center flex-1 space-x-1 btn-success",children:["resume"===l?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(Q.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Resume"})]}):(0,a.jsxs)("button",{onClick:()=>D("start",e.vmid,e.node),disabled:!!l,className:"flex items-center flex-1 space-x-1 btn-success",children:["start"===l?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(Q.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Start"})]})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[t&&(0,a.jsxs)("button",{onClick:()=>t(e.vmid,e.node,"VM ".concat(e.vmid)),disabled:"running"!==e.status,className:"flex items-center flex-1 space-x-1 btn-secondary",children:[(0,a.jsx)(ee.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Console"})]}),s&&(0,a.jsxs)("button",{onClick:()=>s(e.vmid,e.node),className:"flex items-center flex-1 space-x-1 btn-secondary",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Hardware"})]})]})]})]},"".concat(e.node,"-").concat(e.vmid))}))}),0===L.length&&!h&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[(0,a.jsx)(x.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),(0,a.jsx)("h3",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:0===V.length?"No Virtual Machines":"No VMs match your filters"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:0===V.length?f?"No VMs found on node ".concat(f):"No VMs found in cluster":"Try adjusting your search or filter criteria"})]})]})};var te=()=>{const{nodes:e,clusterResources:s,startContainer:t,stopContainer:l,loading:n,error:c,fetchNodes:d,fetchClusterResources:i}=S(),[o,x]=(0,r.useState)(""),[u,h]=(0,r.useState)({}),[g,j]=(0,r.useState)(""),[b,f]=(0,r.useState)("all"),[y,N]=(0,r.useState)(null),v=s.filter((e=>"lxc"===e.type&&(""===o||e.node===o)));(0,r.useEffect)((()=>{e.length>0&&!o&&x(e[0].node)}),[e,o]),(0,r.useEffect)((()=>{w();const e=setInterval(w,1e4);return()=>clearInterval(e)}),[]);const w=(0,r.useCallback)((async()=>{try{await Promise.all([d(),i()]),N(new Date)}catch(c){console.error("Failed to refresh container data:",c)}}),[d,i]),k=async(e,s,a)=>{const r="".concat(a,"-").concat(s);h((s=>({...s,[r]:e})));try{switch(e){case"start":await t(a,s.toString());break;case"stop":await l(a,s.toString())}setTimeout(w,2e3)}catch(c){console.error("Failed to ".concat(e," container:"),c)}finally{h((e=>{const s={...e};return delete s[r],s}))}},C=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,s)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][s])},M=e=>{switch(e){case"running":return"status-running";case"stopped":return"status-stopped";case"suspended":return"status-paused";default:return"status-unknown"}},I=e=>{switch(e){case"running":return(0,a.jsx)(Z.Z,{className:"w-4 h-4"});case"stopped":default:return(0,a.jsx)(P.Z,{className:"w-4 h-4"});case"suspended":return(0,a.jsx)($.Z,{className:"w-4 h-4"})}},F=v.filter((e=>{var s,t;const a=""===g||(null===(s=e.vmid)||void 0===s?void 0:s.toString().includes(g))||(null===(t=e.node)||void 0===t?void 0:t.toLowerCase().includes(g.toLowerCase())),r="all"===b||e.status===b;return a&&r}));return n&&0===v.length?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-gray-300 rounded-full border-t-blue-600 animate-spin"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Loading containers..."})]})}):c?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(P.Z,{className:"w-12 h-12 mx-auto mb-4 text-red-500"}),(0,a.jsx)("h2",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:"Error Loading Containers"}),(0,a.jsx)("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:c}),(0,a.jsxs)("button",{onClick:w,className:"btn-primary",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}):(0,a.jsxs)("div",{className:"min-h-screen p-6 space-y-6 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:justify-between lg:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"LXC Containers"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[F.length," containers \u2022 ",F.filter((e=>"running"===e.status)).length," running"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[y&&(0,a.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last updated: ",y.toLocaleTimeString()]}),(0,a.jsxs)("button",{onClick:w,className:"btn-secondary",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:space-y-0 lg:space-x-6",children:[(0,a.jsxs)("select",{value:o,onChange:e=>x(e.target.value),className:"px-4 py-2 bg-white border border-gray-300 rounded-lg dark:bg-gray-800 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"All Nodes"}),e.map((e=>(0,a.jsx)("option",{value:e.node,children:e.node},e.node)))]}),(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(H.Z,{className:"absolute w-4 h-4 text-gray-400 transform -translate-y-1/2 left-3 top-1/2"}),(0,a.jsx)("input",{type:"text",placeholder:"Search containers...",value:g,onChange:e=>j(e.target.value),className:"w-full py-2 pl-10 pr-4 bg-white border border-gray-300 rounded-lg dark:bg-gray-800 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(W.Z,{className:"w-4 h-4 text-gray-400"}),(0,a.jsxs)("select",{value:b,onChange:e=>f(e.target.value),className:"px-3 py-2 bg-white border border-gray-300 rounded-lg dark:bg-gray-800 dark:border-gray-600 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"running",children:"Running"}),(0,a.jsx)("option",{value:"stopped",children:"Stopped"}),(0,a.jsx)("option",{value:"suspended",children:"Suspended"})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2 xl:grid-cols-3",children:F.map((e=>{const s="".concat(e.node,"-").concat(e.vmid),t=u[s];return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg dark:bg-green-900",children:(0,a.jsx)(m.Z,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:["CT ",e.vmid]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Node: ",e.node]})]})]}),(0,a.jsxs)("span",{className:"inline-flex items-center space-x-1 px-2 py-1 text-xs font-medium rounded-full ".concat(M(e.status)),children:[I(e.status),(0,a.jsx)("span",{children:e.status})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"CPU:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.maxcpu||"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Memory:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.maxmem?C(e.maxmem):"N/A"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Disk:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.maxdisk?C(e.maxdisk):"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Usage:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.cpu?"".concat((100*e.cpu).toFixed(1),"%"):"0%"})]})]})]}),"running"===e.status&&(0,a.jsx)("div",{className:"p-3 mb-4 rounded-lg bg-green-50 dark:bg-green-900/20",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-green-700 dark:text-green-400",children:"CPU:"}),(0,a.jsx)("span",{className:"font-medium text-green-800 dark:text-green-300",children:e.cpu?"".concat((100*e.cpu).toFixed(1),"%"):"0%"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-green-700 dark:text-green-400",children:"Memory:"}),(0,a.jsx)("span",{className:"font-medium text-green-800 dark:text-green-300",children:e.mem&&e.maxmem?"".concat((e.mem/e.maxmem*100).toFixed(1),"%"):"0%"})]})]})}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:["running"===e.status?(0,a.jsxs)("button",{onClick:()=>k("stop",e.vmid,e.node),disabled:!!t,className:"flex items-center flex-1 space-x-1 btn-danger",children:["stop"===t?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(X.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Stop"})]}):(0,a.jsxs)("button",{onClick:()=>k("start",e.vmid,e.node),disabled:!!t,className:"flex items-center flex-1 space-x-1 btn-success",children:["start"===t?(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full border-t-transparent animate-spin"}):(0,a.jsx)(Q.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Start"})]}),(0,a.jsx)("button",{className:"p-2 btn-secondary",children:(0,a.jsx)(p.Z,{className:"w-4 h-4"})})]})})]},"".concat(e.node,"-").concat(e.vmid))}))}),0===F.length&&!n&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[(0,a.jsx)(m.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),(0,a.jsx)("h3",{className:"mb-2 text-lg font-semibold text-gray-900 dark:text-white",children:0===v.length?"No Containers":"No containers match your filters"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:0===v.length?o?"No containers found on node ".concat(o):"No containers found in cluster":"Try adjusting your search or filter criteria"})]})]})};var ae=()=>{const{nodes:e,getStorage:s}=S(),[t,l]=(0,r.useState)({}),[n,c]=(0,r.useState)(!1),[d,o]=(0,r.useState)("");(0,r.useEffect)((()=>{e.length>0&&!d&&o(e[0].node)}),[e,d]),(0,r.useEffect)((()=>{d&&x()}),[d]);const x=async()=>{if(d){c(!0);try{const e=await s(d);l((s=>({...s,[d]:e})))}catch(e){console.error("Failed to fetch storage:",e)}finally{c(!1)}}},m=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB"][s]},u=e=>({dir:"#3b82f6",zfspool:"#10b981",lvm:"#f59e0b","lvm-thin":"#ef4444",nfs:"#8b5cf6",cephfs:"#06b6d4",rbd:"#ec4899"}[e]||"#6b7280"),h=d&&t[d]||[],g=h.map((e=>({name:e.storage,used:e.used||0,available:e.avail||0,total:e.total||0,usedPercent:e.total?Math.round((e.used||0)/e.total*100):0}))),p=h.map((e=>({name:e.storage,value:e.used||0,color:u(e.type)})));return(0,a.jsxs)("div",{className:"p-6 h-full overflow-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Storage Management"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("select",{value:d,onChange:e=>o(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select Node"}),e.map((e=>(0,a.jsx)("option",{value:e.node,children:e.node},e.node)))]}),(0,a.jsx)("button",{onClick:x,disabled:!d,className:"btn-primary",children:"Refresh Node"}),(0,a.jsx)("button",{onClick:async()=>{c(!0);try{const t={};for(const a of e){const e=await s(a.node);t[a.node]=e}l(t)}catch(t){console.error("Failed to fetch all storage:",t)}finally{c(!1)}},className:"btn-secondary",children:"Refresh All"})]})]}),n?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[h.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Storage Usage by Volume"}),(0,a.jsx)(D.h,{width:"100%",height:300,children:(0,a.jsxs)(B.v,{data:g,children:[(0,a.jsx)(E.q,{strokeDasharray:"3 3"}),(0,a.jsx)(R.K,{dataKey:"name"}),(0,a.jsx)(L.B,{tickFormatter:m}),(0,a.jsx)(T.u,{formatter:(e,s)=>[m(e),s],labelFormatter:e=>"Storage: ".concat(e)}),(0,a.jsx)(_.$,{dataKey:"used",fill:"#ef4444",name:"Used"}),(0,a.jsx)(_.$,{dataKey:"available",fill:"#10b981",name:"Available"})]})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Storage Distribution"}),(0,a.jsx)(D.h,{width:"100%",height:300,children:(0,a.jsxs)(K.u,{children:[(0,a.jsx)(q.b,{data:p,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:s,value:t}=e;return"".concat(s,": ").concat(m(t))},outerRadius:80,fill:"#8884d8",dataKey:"value",children:p.map(((e,s)=>(0,a.jsx)(G.b,{fill:e.color},"cell-".concat(s))))}),(0,a.jsx)(T.u,{formatter:e=>m(e)})]})})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Storage Details ",d&&"- ".concat(d)]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Storage"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Content"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Used / Total"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usage %"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map((e=>{const s=e.total?Math.round((e.used||0)/e.total*100):0;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.Z,{className:"h-5 w-5 mr-3",style:{color:u(e.type)}}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.storage}),e.shared&&(0,a.jsx)("div",{className:"text-xs text-blue-600",children:"Shared"})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.type})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.content.split(",").slice(0,2).join(", "),e.content.split(",").length>2&&"..."]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[e.enabled?(0,a.jsx)(O.Z,{className:"h-5 w-5 text-green-500 mr-2"}):(0,a.jsx)(v.Z,{className:"h-5 w-5 text-red-500 mr-2"}),(0,a.jsx)("span",{className:e.enabled?"status-running":"status-stopped",children:e.enabled?"Enabled":"Disabled"})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[m(e.used||0)," / ",m(e.total||0)]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full ".concat(s>80?"bg-red-500":s>60?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(Math.min(s,100),"%")}})}),(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[s,"%"]})]})})]},e.storage)}))})]})})]}),0===h.length&&!n&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(i.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Storage Found"}),(0,a.jsx)("p",{className:"text-gray-500",children:d?"No storage configured on node ".concat(d):"Select a node to view storage"})]})]})]})},re=t(1836),le=t(2990);var ne=()=>{const{nodes:e}=S(),[s,t]=(0,r.useState)({}),[n,c]=(0,r.useState)(!1),[d,i]=(0,r.useState)("");(0,r.useEffect)((()=>{e.length>0&&!d&&i(e[0].node)}),[e,d]);const x=async e=>{const s=[{iface:"vmbr0",type:"bridge",active:!0,address:"192.168.1.100",netmask:"255.255.255.0",gateway:"192.168.1.1",bridge_ports:"eth0",bridge_stp:"off",bridge_fd:"0",autostart:!0},{iface:"vmbr1",type:"bridge",active:!0,address:"10.0.0.1",netmask:"255.255.255.0",bridge_ports:"none",bridge_stp:"off",bridge_fd:"0",autostart:!0},{iface:"eth0",type:"eth",active:!0,autostart:!0},{iface:"eth1",type:"eth",active:!1,autostart:!1}];t((t=>({...t,[e]:s})))};(0,r.useEffect)((()=>{d&&(c(!0),x(d).finally((()=>c(!1))))}),[d]);const m=d&&s[d]||[];return(0,a.jsxs)("div",{className:"p-6 h-full overflow-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Network Management"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("select",{value:d,onChange:e=>i(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select Node"}),e.map((e=>(0,a.jsx)("option",{value:e.node,children:e.node},e.node)))]}),(0,a.jsx)("button",{onClick:()=>d&&x(d),disabled:!d,className:"btn-primary",children:"Refresh"})]})]}),n?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(o.Z,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Bridges"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m.filter((e=>"bridge"===e.type)).length})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(l.Z,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Physical Interfaces"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m.filter((e=>"eth"===e.type)).length})]})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(j.Z,{className:"h-6 w-6 text-purple-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Active Interfaces"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m.filter((e=>e.active)).length})]})]})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Network Interfaces ",d&&"- ".concat(d)]}),(0,a.jsx)("div",{className:"space-y-4",children:m.map(((e,s)=>{const t=(e=>{switch(e){case"bridge":return o.Z;case"eth":return l.Z;case"bond":return re.Z;default:return le.Z}})(e.type),r=((e,s)=>{if(!s)return"text-gray-400";switch(e){case"bridge":return"text-blue-600";case"eth":return"text-green-600";case"bond":return"text-purple-600";default:return"text-gray-600"}})(e.type,e.active);return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(t,{className:"h-8 w-8 mr-3 ".concat(r)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.iface}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 capitalize",children:[e.type," Interface"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:e.active?"status-running":"status-stopped",children:e.active?"Active":"Inactive"}),e.autostart&&(0,a.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:"Auto-start"})]})]}),(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.address&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"IP Address"}),(0,a.jsx)("p",{className:"font-medium",children:e.address})]}),e.netmask&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Netmask"}),(0,a.jsx)("p",{className:"font-medium",children:e.netmask})]}),e.gateway&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Gateway"}),(0,a.jsx)("p",{className:"font-medium",children:e.gateway})]}),e.bridge_ports&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Bridge Ports"}),(0,a.jsx)("p",{className:"font-medium",children:e.bridge_ports})]}),e.bridge_stp&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"STP"}),(0,a.jsx)("p",{className:"font-medium",children:e.bridge_stp})]}),e.bridge_fd&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Forward Delay"}),(0,a.jsx)("p",{className:"font-medium",children:e.bridge_fd})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,a.jsx)("button",{className:"btn-secondary",children:"Edit"}),(0,a.jsx)("button",{className:"btn-secondary",children:"Configure"}),!e.active&&(0,a.jsx)("button",{className:"btn-success",children:"Activate"})]})]},s)}))})]}),0===m.length&&!n&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(o.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Network Interfaces"}),(0,a.jsx)("p",{className:"text-gray-500",children:d?"No network interfaces found on node ".concat(d):"Select a node to view network configuration"})]})]})]})},ce=t(8347),de=t(705),ie=t(4318),oe=t(9464),xe=t(8255),me=t(8260);var ue=()=>{const{nodes:e}=S(),[s,t]=(0,r.useState)([]),[l,n]=(0,r.useState)([]),[c,d]=(0,r.useState)(!1),[i,o]=(0,r.useState)("jobs"),[x,m]=(0,r.useState)(!1);(0,r.useEffect)((()=>{h()}),[]);const h=async()=>{d(!0);try{const e=[{id:"1",node:"pve-node1",vmid:100,type:"qemu",schedule:"0 2 * * *",enabled:!0,storage:"backup-storage",compress:"lzo",mode:"snapshot"},{id:"2",node:"pve-node1",vmid:101,type:"lxc",schedule:"0 3 * * 0",enabled:!0,storage:"backup-storage",compress:"gzip",mode:"stop"}],s=[{volid:"backup-storage:backup/vzdump-qemu-100-2024_06_01-02_00_15.vma.lzo",vmid:100,size:5368709120,ctime:Date.now()-864e5,format:"vma.lzo",content:"backup"},{volid:"backup-storage:backup/vzdump-lxc-101-2024_05_31-03_00_20.tar.gz",vmid:101,size:1073741824,ctime:Date.now()-1728e5,format:"tar.gz",content:"backup"}];t(e),n(s)}catch(e){console.error("Failed to fetch backup data:",e)}finally{d(!1)}},g=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB"][s]},p=e=>{const s=e.split(" ");if(s.length>=5){const e=s[0],t=s[1],a=s[2],r=s[3],l=s[4];if("*"===a&&"*"===r&&"*"===l)return"Daily at ".concat(t,":").concat(e.padStart(2,"0"));if("*"===a&&"*"===r&&"*"!==l){return"Weekly on ".concat(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][parseInt(l)]," at ").concat(t,":").concat(e.padStart(2,"0"))}}return e};return(0,a.jsxs)("div",{className:"p-6 h-full overflow-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Backup Management"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,a.jsx)("button",{onClick:()=>o("jobs"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("jobs"===i?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Backup Jobs"}),(0,a.jsx)("button",{onClick:()=>o("files"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("files"===i?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Backup Files"})]}),(0,a.jsxs)("button",{onClick:()=>m(!0),className:"btn-primary flex items-center space-x-2",children:[(0,a.jsx)(ce.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Create Backup"})]}),(0,a.jsx)("button",{onClick:h,className:"btn-secondary",children:"Refresh"})]})]}),c?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600"})}):"jobs"===i?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Scheduled Backup Jobs"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"VM/CT"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Node"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Schedule"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Storage"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Settings"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map((e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 text-blue-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.type.toUpperCase()," ",e.vmid]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"qemu"===e.type?"Virtual Machine":"Container"})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.node}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(de.Z,{className:"h-4 w-4 text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:p(e.schedule)})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.storage}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,a.jsxs)("div",{children:["Mode: ",e.mode]}),(0,a.jsxs)("div",{children:["Compression: ",e.compress]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:e.enabled?"status-running":"status-stopped",children:e.enabled?"Enabled":"Disabled"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-900",children:"Edit"}),(0,a.jsx)("button",{className:"text-green-600 hover:text-green-900",children:"Run Now"}),(0,a.jsx)("button",{className:"text-red-600 hover:text-red-900",children:"Delete"})]})})]},e.id)))})]})})]})}):(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Backup Files"}),(0,a.jsx)("div",{className:"space-y-4",children:l.map(((e,s)=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-8 w-8 text-green-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900",children:["VM/CT ",e.vmid," Backup"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.volid.split(":")[1]}),(0,a.jsxs)("div",{className:"flex items-center mt-1 space-x-4 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ie.Z,{className:"h-4 w-4 mr-1"}),(0,me.Z)(new Date(e.ctime),"PPP p")]}),(0,a.jsx)("div",{children:g(e.size)}),(0,a.jsx)("div",{children:e.format})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("button",{className:"btn-secondary flex items-center space-x-1",children:[(0,a.jsx)(oe.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Download"})]}),(0,a.jsx)("button",{className:"btn-secondary",children:"Restore"}),(0,a.jsx)("button",{className:"btn-danger p-2",children:(0,a.jsx)(xe.Z,{className:"h-4 w-4"})})]})]})},s)))})]})}),0===s.length&&"jobs"===i&&!c&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(u.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Backup Jobs"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Create your first backup job to get started"})]}),0===l.length&&"files"===i&&!c&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(u.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Backup Files"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No backup files found in storage"})]}),x&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Backup Job"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Node"}),(0,a.jsx)("select",{className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:e.map((e=>(0,a.jsx)("option",{value:e.node,children:e.node},e.node)))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"VM/Container ID"}),(0,a.jsx)("input",{type:"number",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"100"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Storage"}),(0,a.jsxs)("select",{className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"backup-storage",children:"backup-storage"}),(0,a.jsx)("option",{value:"local",children:"local"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Mode"}),(0,a.jsxs)("select",{className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"snapshot",children:"Snapshot"}),(0,a.jsx)("option",{value:"suspend",children:"Suspend"}),(0,a.jsx)("option",{value:"stop",children:"Stop"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Compression"}),(0,a.jsxs)("select",{className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"lzo",children:"LZO"}),(0,a.jsx)("option",{value:"gzip",children:"GZIP"}),(0,a.jsx)("option",{value:"zstd",children:"ZSTD"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{onClick:()=>m(!1),className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{m(!1)},className:"btn-primary",children:"Create Backup"})]})]})})})]})};var he=e=>{let{connection:s,setConnection:t}=e;var l,n;const[c,d]=(0,r.useState)({host:"",port:8006,username:"root",password:"",realm:"pam",ignoreSSL:!0}),[i,o]=(0,r.useState)(!1),[x,m]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),[g,j]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(s.config)d(s.config);else{const s=localStorage.getItem("proxmox-config");if(s)try{d(JSON.parse(s))}catch(e){console.error("Failed to parse saved config:",e)}}}),[s.config]);const b=(e,s)=>{d((t=>({...t,[e]:s}))),m(null)};return(0,a.jsx)("div",{className:"p-6 h-full overflow-auto",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(p.Z,{className:"h-8 w-8 text-gray-600 mr-3"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Settings"})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Proxmox VE Connection"}),s.connected&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-md",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(O.Z,{className:"h-5 w-5 text-green-600 mr-2"}),(0,a.jsxs)("span",{className:"text-green-800 font-medium",children:["Connected to ",null===(l=s.config)||void 0===l?void 0:l.host,":",null===(n=s.config)||void 0===n?void 0:n.port]})]}),(0,a.jsx)("button",{onClick:async()=>{try{await window.electronAPI.disconnect(),t({connected:!1,config:null}),m(null)}catch(e){console.error("Failed to disconnect:",e)}},className:"mt-2 btn-danger",children:"Disconnect"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Host/IP Address"}),(0,a.jsx)("input",{type:"text",value:c.host,onChange:e=>b("host",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"192.168.1.100"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),(0,a.jsx)("input",{type:"number",value:c.port,onChange:e=>b("port",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1",max:"65535"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),(0,a.jsx)("input",{type:"text",value:c.username,onChange:e=>b("username",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"root"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Realm"}),(0,a.jsxs)("select",{value:c.realm,onChange:e=>b("realm",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"pam",children:"Linux PAM"}),(0,a.jsx)("option",{value:"pve",children:"Proxmox VE"}),(0,a.jsx)("option",{value:"ad",children:"Active Directory"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:u?"text":"password",value:c.password,onChange:e=>b("password",e.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter password"}),(0,a.jsx)("button",{type:"button",onClick:()=>h(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:u?(0,a.jsx)(C.Z,{className:"h-4 w-4 text-gray-400"}):(0,a.jsx)(M.Z,{className:"h-4 w-4 text-gray-400"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"ignoreSSL",checked:c.ignoreSSL,onChange:e=>b("ignoreSSL",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"ignoreSSL",className:"ml-2 block text-sm text-gray-700",children:"Ignore SSL certificate errors"})]}),x&&(0,a.jsx)("div",{className:"p-4 rounded-md ".concat(x.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[x.success?(0,a.jsx)(O.Z,{className:"h-5 w-5 text-green-600 mr-2"}):(0,a.jsx)(P.Z,{className:"h-5 w-5 text-red-600 mr-2"}),(0,a.jsx)("span",{className:x.success?"text-green-800":"text-red-800",children:x.message})]})}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:async()=>{o(!0),m(null);try{const e=await window.electronAPI.connect(c);e.success?m({success:!0,message:"Connection successful!"}):m({success:!1,message:e.error||"Connection failed"})}catch(e){m({success:!1,message:e.message})}finally{o(!1)}},disabled:i||!c.host||!c.username||!c.password,className:"btn-secondary flex items-center space-x-2",children:[i?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}):(0,a.jsx)(I.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Test Connection"})]}),(0,a.jsxs)("button",{onClick:async()=>{j(!0);try{const e=await window.electronAPI.connect(c);e.success?(localStorage.setItem("proxmox-config",JSON.stringify(c)),t({connected:!0,config:c}),m({success:!0,message:"Connected successfully!"})):m({success:!1,message:e.error||"Connection failed"})}catch(e){m({success:!1,message:e.message})}finally{j(!1)}},disabled:g||!c.host||!c.username||!c.password||s.connected,className:"btn-primary flex items-center space-x-2",children:[g?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,a.jsx)(F.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Save & Connect"})]})]})]})]}),(0,a.jsxs)("div",{className:"card mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Application Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Auto-refresh interval"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"How often to refresh data automatically"})]}),(0,a.jsxs)("select",{className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"30",children:"30 seconds"}),(0,a.jsx)("option",{value:"60",children:"1 minute"}),(0,a.jsx)("option",{value:"300",children:"5 minutes"}),(0,a.jsx)("option",{value:"0",children:"Disabled"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Show notifications"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Display system notifications for events"})]}),(0,a.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Dark mode"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Use dark color scheme"})]}),(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})]})]})]})]})})},ge=t(3710),pe=t(6782);var je=()=>{const[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)([]),[n,c]=(0,r.useState)([]),[d,i]=(0,r.useState)(!1),[o,x]=(0,r.useState)("users"),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),[j,b]=(0,r.useState)(!1),[f,y]=(0,r.useState)({userid:"",password:"",firstname:"",lastname:"",email:"",groups:[],enable:!0,comment:"",realm:"pve"});(0,r.useEffect)((()=>{N()}),[]);const N=async()=>{i(!0);try{const e=[{groupid:"admin",comment:"Administrators with full access",members:["root@pam"]},{groupid:"users",comment:"Regular users with limited access",members:["user1@pve"]},{groupid:"backup",comment:"Backup operators",members:["backup@pve"]}],t=[{roleid:"Administrator",privs:["*"]},{roleid:"VMUser",privs:["VM.Console","VM.PowerMgmt","VM.Monitor"]},{roleid:"BackupOperator",privs:["Datastore.Backup","VM.Backup"]}];s([{userid:"root@pam",firstname:"Administrator",lastname:"Root",email:"admin@example.com",groups:["admin"],enable:!0,comment:"System administrator"},{userid:"user1@pve",firstname:"John",lastname:"Doe",email:"john.doe@example.com",groups:["users"],enable:!0,comment:"Regular user"},{userid:"backup@pve",firstname:"Backup",lastname:"Service",email:"backup@example.com",groups:["backup"],enable:!0,comment:"Backup service account"}]),l(e),c(t)}catch(e){console.error("Failed to fetch user data:",e)}finally{i(!1)}},v=()=>{y({userid:"",password:"",firstname:"",lastname:"",email:"",groups:[],enable:!0,comment:"",realm:"pve"})},w=e=>{if(p(e),"users"===o){const[s,t]=e.userid.split("@");y({userid:s,password:"",firstname:e.firstname||"",lastname:e.lastname||"",email:e.email||"",groups:e.groups||[],enable:e.enable,comment:e.comment||"",realm:t||"pve"})}u(!0)},k=a=>{confirm("Are you sure you want to delete ".concat(a,"?"))&&("users"===o?s(e.filter((e=>e.userid!==a))):"groups"===o&&l(t.filter((e=>e.groupid!==a))))};return(0,a.jsxs)("div",{className:"h-full p-6 overflow-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"User Management"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex p-1 bg-gray-100 rounded-lg",children:[(0,a.jsx)("button",{onClick:()=>x("users"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("users"===o?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Users"}),(0,a.jsx)("button",{onClick:()=>x("groups"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("groups"===o?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Groups"}),(0,a.jsx)("button",{onClick:()=>x("roles"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("roles"===o?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Roles"})]}),(0,a.jsxs)("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 btn-primary",children:[(0,a.jsx)(ce.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Create ",o.slice(0,-1)]})]}),(0,a.jsx)("button",{onClick:N,className:"btn-secondary",children:"Refresh"})]})]}),d?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"w-16 h-16 border-b-2 border-blue-600 rounded-full animate-spin"})}):(0,a.jsxs)(a.Fragment,{children:["users"===o&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900",children:"Users"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"User ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Groups"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((e=>{var s;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(g.Z,{className:"w-5 h-5 mr-3 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.userid}),e.comment&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.comment})]})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:[e.firstname," ",e.lastname]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 whitespace-nowrap",children:e.email}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:null===(s=e.groups)||void 0===s?void 0:s.map((e=>(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium text-blue-800 bg-blue-100 rounded-full",children:e},e)))})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:e.enable?"status-running":"status-stopped",children:e.enable?"Enabled":"Disabled"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>w(e),className:"text-blue-600 hover:text-blue-900",children:(0,a.jsx)(ge.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>k(e.userid),className:"text-red-600 hover:text-red-900",children:(0,a.jsx)(xe.Z,{className:"w-4 h-4"})})]})})]},e.userid)}))})]})})]})}),"groups"===o&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900",children:"Groups"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map((e=>{var s,t,r,l;return(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(re.Z,{className:"w-6 h-6 mr-2 text-purple-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.groupid}),e.comment&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.comment})]})]}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>w(e),className:"text-blue-600 hover:text-blue-900",children:(0,a.jsx)(ge.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>k(e.groupid),className:"text-red-600 hover:text-red-900",children:(0,a.jsx)(xe.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:["Members (",(null===(s=e.members)||void 0===s?void 0:s.length)||0,")"]}),(0,a.jsxs)("div",{className:"space-y-1",children:[null===(t=e.members)||void 0===t?void 0:t.slice(0,3).map((e=>(0,a.jsx)("div",{className:"text-sm text-gray-700",children:e},e))),((null===(r=e.members)||void 0===r?void 0:r.length)||0)>3&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["+",((null===(l=e.members)||void 0===l?void 0:l.length)||0)-3," more"]})]})]})]},e.groupid)}))})]})}),"roles"===o&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900",children:"Roles"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:n.map((e=>(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(pe.Z,{className:"w-6 h-6 mr-2 text-green-600"}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.roleid})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:["Privileges (",e.privs.length,")"]}),(0,a.jsxs)("div",{className:"space-y-1",children:[e.privs.slice(0,5).map((e=>(0,a.jsx)("div",{className:"px-2 py-1 text-sm text-gray-700 rounded bg-gray-50",children:e},e))),e.privs.length>5&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["+",e.privs.length-5," more"]})]})]})]},e.roleid)))})]})})]}),m&&"users"===o&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 w-full h-full overflow-y-auto bg-gray-600 bg-opacity-50",children:(0,a.jsx)("div",{className:"relative p-5 mx-auto bg-white border rounded-md shadow-lg top-20 w-96",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900",children:h?"Edit User":"Create New User"}),(0,a.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),"users"===o){const t={userid:"".concat(f.userid,"@").concat(f.realm),firstname:f.firstname,lastname:f.lastname,email:f.email,groups:f.groups,enable:f.enable,comment:f.comment};s(h?e.map((e=>e.userid===h.userid?t:e)):[...e,t])}u(!1),p(null),v()},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,a.jsx)("input",{type:"text",value:f.userid,onChange:e=>y((s=>({...s,userid:e.target.value}))),className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Realm"}),(0,a.jsxs)("select",{value:f.realm,onChange:e=>y((s=>({...s,realm:e.target.value}))),className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"pve",children:"Proxmox VE"}),(0,a.jsx)("option",{value:"pam",children:"Linux PAM"}),(0,a.jsx)("option",{value:"ad",children:"Active Directory"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:j?"text":"password",value:f.password,onChange:e=>y((s=>({...s,password:e.target.value}))),className:"block w-full px-3 py-2 pr-10 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!h}),(0,a.jsx)("button",{type:"button",onClick:()=>b(!j),className:"absolute inset-y-0 right-0 flex items-center pr-3",children:j?(0,a.jsx)(C.Z,{className:"w-4 h-4 text-gray-400"}):(0,a.jsx)(M.Z,{className:"w-4 h-4 text-gray-400"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),(0,a.jsx)("input",{type:"text",value:f.firstname,onChange:e=>y((s=>({...s,firstname:e.target.value}))),className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),(0,a.jsx)("input",{type:"text",value:f.lastname,onChange:e=>y((s=>({...s,lastname:e.target.value}))),className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("input",{type:"email",value:f.email,onChange:e=>y((s=>({...s,email:e.target.value}))),className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Comment"}),(0,a.jsx)("textarea",{value:f.comment,onChange:e=>y((s=>({...s,comment:e.target.value}))),className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",rows:2})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"enable",checked:f.enable,onChange:e=>y((s=>({...s,enable:e.target.checked}))),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,a.jsx)("label",{htmlFor:"enable",className:"block ml-2 text-sm text-gray-700",children:"Enable user account"})]}),(0,a.jsxs)("div",{className:"flex justify-end mt-6 space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{u(!1),p(null),v()},className:"btn-secondary",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",className:"btn-primary",children:[h?"Update":"Create"," User"]})]})]})]})})})]})},be=t(9735);var fe=()=>{var e,s;const{nodes:t}=S(),[l,n]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[o,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)(""),[g,p]=(0,r.useState)({}),[j,b]=(0,r.useState)(!1),[f,y]=(0,r.useState)(null),[N,v]=(0,r.useState)("");(0,r.useEffect)((()=>{w()}),[t]),(0,r.useEffect)((()=>{m&&k()}),[m]);const w=async()=>{x(!0);try{const e=[{storage:"local",node:"pve-node1",type:"dir",content:"iso,backup,vztmpl",enabled:!0,shared:!1},{storage:"iso-storage",node:"pve-node1",type:"nfs",content:"iso",enabled:!0,shared:!0},{storage:"backup-storage",node:"pve-node1",type:"nfs",content:"backup,iso",enabled:!0,shared:!0}].filter((e=>e.content.includes("iso")&&e.enabled));d(e),e.length>0&&!m&&u(e[0].storage)}catch(e){console.error("Failed to fetch storage nodes:",e)}finally{x(!1)}},k=async()=>{if(m){x(!0);try{const e=[{volid:"".concat(m,":iso/ubuntu-22.04.3-live-server-amd64.iso"),content:"iso",size:1234567890,ctime:Date.now()-6048e5,format:"iso",storage:m,notes:"Ubuntu 22.04 LTS Server"},{volid:"".concat(m,":iso/debian-12.2.0-amd64-netinst.iso"),content:"iso",size:654321098,ctime:Date.now()-2592e5,format:"iso",storage:m,notes:"Debian 12 Bookworm"},{volid:"".concat(m,":iso/proxmox-ve_8.1-1.iso"),content:"iso",size:987654321,ctime:Date.now()-12096e5,format:"iso",storage:m,notes:"Proxmox VE 8.1"},{volid:"".concat(m,":iso/windows-server-2022.iso"),content:"iso",size:5432109876,ctime:Date.now()-18144e5,format:"iso",storage:m,notes:"Windows Server 2022"}];n(e)}catch(e){console.error("Failed to fetch ISO files:",e)}finally{x(!1)}}},C=e=>{if(0===e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB"][s]},M=e=>{const s=e.split("/");return s[s.length-1]};return(0,a.jsxs)("div",{className:"h-full p-6 overflow-auto bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"ISO Management"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("select",{value:m,onChange:e=>u(e.target.value),className:"px-3 py-2 text-gray-900 bg-white border border-gray-300 rounded-md dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[(0,a.jsx)("option",{value:"",children:"Select Storage"}),c.map((e=>(0,a.jsxs)("option",{value:e.storage,children:[e.storage," (",e.type,")"]},e.storage)))]}),(0,a.jsxs)("button",{onClick:()=>b(!0),disabled:!m,className:"flex items-center space-x-2 btn-primary",children:[(0,a.jsx)(be.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Upload ISO"})]}),(0,a.jsxs)("button",{onClick:k,disabled:!m,className:"flex items-center space-x-2 btn-secondary",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Refresh"})]})]})]}),m&&(0,a.jsx)("div",{className:"mb-6 card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.Z,{className:"w-6 h-6 mr-3 text-blue-600 dark:text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:m}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[null===(e=c.find((e=>e.storage===m)))||void 0===e?void 0:e.type," Storage",(null===(s=c.find((e=>e.storage===m)))||void 0===s?void 0:s.shared)&&" \u2022 Shared"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total ISOs"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:l.length})]})]})}),o?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"w-16 h-16 border-b-2 border-blue-600 rounded-full animate-spin"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[Object.keys(g).length>0&&(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-white",children:"Upload Progress"}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(g).map((e=>{let[s,t]=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1 text-sm",children:[(0,a.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:s}),(0,a.jsxs)("span",{className:"text-gray-500 dark:text-gray-400",children:[Math.round(t),"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full dark:bg-gray-700",children:(0,a.jsx)("div",{className:"h-2 transition-all duration-300 bg-blue-600 rounded-full",style:{width:"".concat(t,"%")}})})]},s)}))})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:l.map((e=>(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Z,{className:"w-8 h-8 mr-3 text-orange-600"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 truncate dark:text-white",children:M(e.volid)}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.storage})]})]})}),e.notes&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("p",{className:"p-2 text-sm text-gray-600 rounded dark:text-gray-400 bg-gray-50 dark:bg-gray-700",children:e.notes})}),(0,a.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Size:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:C(e.size)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Created:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:(0,me.Z)(new Date(e.ctime),"MMM dd, yyyy")})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Format:"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 uppercase dark:text-white",children:e.format})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>(e=>{const s=M(e);alert("Download initiated for ".concat(s))})(e.volid),className:"flex items-center flex-1 space-x-1 btn-secondary",children:[(0,a.jsx)(oe.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Download"})]}),(0,a.jsx)("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this ISO file?"))try{n((s=>s.filter((s=>s.volid!==e))))}catch(s){console.error("Failed to delete ISO file:",s)}})(e.volid),className:"p-2 btn-danger",children:(0,a.jsx)(xe.Z,{className:"w-4 h-4"})})]})]},e.volid)))}),0===l.length&&!o&&(0,a.jsxs)("div",{className:"py-12 text-center",children:[(0,a.jsx)(h.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-400 dark:text-gray-500"}),(0,a.jsx)("h3",{className:"mb-2 text-lg font-medium text-gray-700 dark:text-gray-300",children:"No ISO Files"}),(0,a.jsx)("p",{className:"mb-4 text-gray-500 dark:text-gray-400",children:m?"No ISO files found in ".concat(m):"Select a storage to view ISO files"}),m&&(0,a.jsx)("button",{onClick:()=>b(!0),className:"btn-primary",children:"Upload Your First ISO"})]})]}),j&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 w-full h-full overflow-y-auto bg-gray-600 bg-opacity-50",children:(0,a.jsx)("div",{className:"relative p-5 mx-auto bg-white border rounded-md shadow-lg top-20 w-96 dark:bg-gray-800",children:(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h3",{className:"mb-4 text-lg font-medium text-gray-900 dark:text-white",children:"Upload ISO Files"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Target Storage"}),(0,a.jsxs)("select",{value:N,onChange:e=>v(e.target.value),className:"block w-full px-3 py-2 mt-1 text-gray-900 bg-white border border-gray-300 rounded-md shadow-sm dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white",children:[(0,a.jsx)("option",{value:"",children:"Select Storage"}),c.map((e=>(0,a.jsxs)("option",{value:e.storage,children:[e.storage," (",e.type,")"]},e.storage)))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"ISO Files"}),(0,a.jsx)("input",{type:"file",multiple:!0,accept:".iso",onChange:e=>y(e.target.files),className:"block w-full px-3 py-2 mt-1 text-gray-900 bg-white border border-gray-300 rounded-md shadow-sm dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Select one or more ISO files to upload. Only .iso files are accepted."})]}),f&&(0,a.jsxs)("div",{className:"p-3 rounded bg-gray-50 dark:bg-gray-700",children:[(0,a.jsxs)("p",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:["Selected Files (",f.length,"):"]}),(0,a.jsx)("div",{className:"space-y-1",children:Array.from(f).map(((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 truncate dark:text-gray-400",children:e.name}),(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:C(e.size)})]},s)))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end mt-6 space-x-3",children:[(0,a.jsx)("button",{onClick:()=>{b(!1),y(null),v("")},className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{onClick:async()=>{if(!f||!N)return;const e=Array.from(f);for(const t of e){const e=t.name;p((s=>({...s,[e]:0})));try{const s=setInterval((()=>{p((a=>{const r=a[e]||0,l=Math.min(r+20*Math.random(),100);if(l>=100){clearInterval(s);const a={volid:"".concat(N,":iso/").concat(t.name),content:"iso",size:t.size,ctime:Date.now(),format:"iso",storage:N,notes:"Uploaded ".concat((0,me.Z)(new Date,"PPP"))};n((e=>[a,...e])),setTimeout((()=>{p((s=>{const t={...s};return delete t[e],t}))}),2e3)}return{...a,[e]:l}}))}),500)}catch(s){console.error("Failed to upload ".concat(t.name,":"),s),p((s=>{const t={...s};return delete t[e],t}))}}b(!1),y(null)},disabled:!f||!N,className:"btn-primary",children:"Upload Files"})]})]})})})]})};const ye=()=>{const{isDarkMode:e,toggleDarkMode:s}=(()=>{const e=(0,r.useContext)(w);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e})(),[t,k]=(0,r.useState)("connection"),[C,M]=(0,r.useState)(!1),[Z,P]=(0,r.useState)(null),{nodes:I,clusterResources:F,loading:A,error:U,fetchNodes:D,fetchClusterResources:B}=S(),[E,R]=(0,r.useState)(!1),[L,T]=(0,r.useState)(!1),[_,O]=(0,r.useState)(null),[K,q]=(0,r.useState)([]),G=e=>{q((s=>[e,...s.slice(0,4)]))};(0,r.useEffect)((()=>{const e=localStorage.getItem("proxmox-connection-config");if(e)try{const s=JSON.parse(e);P(s)}catch(U){console.error("Failed to parse saved config:",U)}}),[]),(0,r.useEffect)((()=>{E&&"connection"===t?k("dashboard"):E||"connection"===t||"settings"===t||k("connection")}),[E,t]);const $=async(e,s)=>{if(R(e),e&&s){P(s),O(null);try{await Promise.all([D(),B()])}catch(U){console.error("Failed to fetch initial data:",U),G("Failed to fetch initial data")}}else P(null),O(null)},H=[{name:"Connection",items:[{id:"connection",label:"Connection",icon:E?l.Z:n.Z,description:E?"Connected":"Not connected",color:E?"text-green-600":"text-red-600"}]},{name:"Overview",items:[{id:"dashboard",label:"Dashboard",icon:c.Z,requiresConnection:!0,description:"Cluster overview"}]},{name:"Infrastructure",items:[{id:"nodes",label:"Nodes",icon:d.Z,requiresConnection:!0,description:"Node management"},{id:"storage",label:"Storage",icon:i.Z,requiresConnection:!0,description:"Storage pools"},{id:"network",label:"Network",icon:o.Z,requiresConnection:!0,description:"Network configuration"}]},{name:"Compute",items:[{id:"vms",label:"Virtual Machines",icon:x.Z,requiresConnection:!0,description:"VM management"},{id:"containers",label:"Containers",icon:m.Z,requiresConnection:!0,description:"LXC containers"}]},{name:"Data & Security",items:[{id:"backups",label:"Backups",icon:u.Z,requiresConnection:!0,description:"Backup management"},{id:"iso",label:"ISO Images",icon:h.Z,requiresConnection:!0,description:"ISO management"},{id:"users",label:"Users",icon:g.Z,requiresConnection:!0,description:"User management"}]},{name:"System",items:[{id:"settings",label:"Settings",icon:p.Z,description:"Application settings"}]}];return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"".concat(C?"w-16":"w-64"," transition-all duration-300 bg-white border-r border-gray-200 shadow-sm dark:bg-gray-800 dark:border-gray-700 flex flex-col"),children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-600 rounded-lg",children:(0,a.jsx)(j.Z,{className:"w-5 h-5 text-white"})}),!C&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"ProxTop"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Proxmox Manager"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[!C&&(0,a.jsx)("button",{onClick:s,className:"p-1.5 text-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-gray-400",children:e?(0,a.jsx)(b.Z,{className:"w-4 h-4"}):(0,a.jsx)(f.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>M(!C),className:"p-1.5 text-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-gray-400",children:C?(0,a.jsx)(y.Z,{className:"w-4 h-4"}):(0,a.jsx)(N.Z,{className:"w-4 h-4"})})]})]})}),(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:E&&Z?(0,a.jsx)("div",{className:"p-3 border border-green-200 rounded-lg bg-green-50 dark:bg-green-900/20 dark:border-green-800",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),!C&&(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-800 truncate dark:text-green-400",children:"Connected"}),(0,a.jsxs)("p",{className:"text-xs text-green-600 truncate dark:text-green-500",children:[Z.host,":",Z.port]})]})]})}):L?(0,a.jsx)("div",{className:"p-3 border border-blue-200 rounded-lg bg-blue-50 dark:bg-blue-900/20 dark:border-blue-800",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),!C&&(0,a.jsx)("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-400",children:"Connecting..."})]})}):(0,a.jsx)("div",{className:"p-3 border border-gray-200 rounded-lg bg-gray-50 dark:bg-gray-900/20 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),!C&&(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Not Connected"})]})})}),K.length>0&&!C&&(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)("div",{className:"p-3 border border-red-200 rounded-lg bg-red-50 dark:bg-red-900/20 dark:border-red-800",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(v.Z,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:K[0]}),K.length>1&&(0,a.jsxs)("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:["+",K.length-1," more errors"]})]})]}),(0,a.jsx)("button",{onClick:()=>{q([])},className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-200",children:(0,a.jsx)(N.Z,{className:"w-4 h-4"})})]})})}),(0,a.jsx)("nav",{className:"flex-1 p-4 space-y-6 overflow-y-auto",children:H.map((e=>(0,a.jsxs)("div",{children:[!C&&(0,a.jsx)("h3",{className:"px-2 mb-3 text-xs font-semibold tracking-wider text-gray-500 uppercase dark:text-gray-400",children:e.name}),(0,a.jsx)("div",{className:"space-y-1",children:e.items.map((e=>{const s=e.icon,r=e.requiresConnection&&!E,l=t===e.id;return(0,a.jsxs)("button",{onClick:()=>!r&&k(e.id),disabled:r,className:"group relative w-full flex items-center rounded-lg transition-colors duration-200 ".concat(C?"p-2 justify-center":"px-3 py-2"," ").concat(r?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer"," ").concat(l?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400":"text-gray-700 dark:text-gray-300"),title:C?e.label:void 0,children:[(0,a.jsx)(s,{className:"flex-shrink-0 w-5 h-5 ".concat(e.color||"")}),!C&&(0,a.jsxs)("div",{className:"ml-3 text-left",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.label}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.description})]}),C&&(0,a.jsx)("div",{className:"absolute z-50 px-2 py-1 ml-2 text-xs font-medium text-white transition-opacity duration-200 bg-gray-900 rounded shadow-lg opacity-0 pointer-events-none left-full group-hover:opacity-100 whitespace-nowrap",children:e.label})]},e.id)}))})]},e.name)))}),!C&&(0,a.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ProxTop v1.0.0"}),Z&&(0,a.jsxs)("p",{className:"mt-1 text-xs text-gray-400 dark:text-gray-500",children:[Z.username,"@",Z.realm]})]})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(()=>{switch(t){case"connection":default:return(0,a.jsx)(V,{onConnectionChange:$});case"dashboard":return(0,a.jsx)(z,{});case"nodes":return(0,a.jsx)(J,{});case"vms":return(0,a.jsx)(se,{});case"containers":return(0,a.jsx)(te,{});case"storage":return(0,a.jsx)(ae,{});case"network":return(0,a.jsx)(ne,{});case"backups":return(0,a.jsx)(ue,{});case"iso":return(0,a.jsx)(fe,{});case"users":return(0,a.jsx)(je,{});case"settings":return(0,a.jsx)(he,{connection:{connected:E,config:Z},setConnection:()=>{}})}})()})]})};var Ne=()=>(0,a.jsx)(k,{children:(0,a.jsx)(ye,{})});function ve(){return(0,a.jsx)(Ne,{})}}},function(e){e.O(0,[25,774,888,179],(function(){return s=8312,e(e.s=s);var s}));var s=e.O();_N_E=s}]);